# UTM Connect Backend

SOLID-ะฐััะธัะตะบัััะฐ ะฑัะบะตะฝะดะฐ ะดะปั UTM Connect

## ๐ ะขัะตะฑะพะฒะฐะฝะธั

- Node.js 18+
- PostgreSQL 12+

## ๐ ะฃััะฐะฝะพะฒะบะฐ

```bash
# ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ
npm install

# ะะฐัััะพะธัั ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
cp .env.example .env

# ะกะพะทะดะฐัั ะฑะฐะทั ะดะฐะฝะฝัั ะธ ะฟัะธะผะตะฝะธัั ะผะธะณัะฐัะธะธ
npm run prisma:migrate

# ะะฐะทะฒะตัะฝััั ัะตัะฒะตั
npm run dev
```

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
src/
โโโ config/          # ะะพะฝัะธะณััะฐัะธั (ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั)
โโโ prisma/          # Prisma ะบะปะธะตะฝั
โโโ types/           # TypeScript ัะธะฟั ะธ ะธะฝัะตััะตะนัั
โโโ repositories/    # Data Access Layer (DAL)
โโโ services/        # Business Logic Layer (BLL)
โโโ routes/          # API ะผะฐัััััั
โโโ index.ts         # ะขะพัะบะฐ ะฒัะพะดะฐ
```

## ๐๏ธ SOLID ะฟัะธะฝัะธะฟั

### 1. **Single Responsibility Principle (SRP)**
ะะฐะถะดัะน ะบะปะฐัั ะพัะฒะตัะฐะตั ะทะฐ ะพะดะฝั ะทะฐะดะฐัั:
- `UserRepository` - ัะฐะฑะพัะฐ ั ะะ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- `UserService` - ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- `users.ts` (routes) - HTTP ัะฝะดะฟะพะธะฝัั

### 2. **Open/Closed Principle (OCP)**
ะัะฟะพะปัะทััััั ะธะฝัะตััะตะนัั (`IUserRepository`, `ILinkRepository`, `ICampaignRepository`):
```typescript
export interface IUserRepository {
  create(data: CreateUserDTO): Promise<UserEntity>;
  findById(id: string): Promise<UserEntity | null>;
  // ...
}
```

### 3. **Liskov Substitution Principle (LSP)**
ะะตะฐะปะธะทะฐัะธะธ ัะตะฟะพะทะธัะพัะธะตะฒ ะฒะทะฐะธะผะพะทะฐะผะตะฝัะตะผั ัะตัะตะท ะธะฝัะตััะตะนัั.

### 4. **Interface Segregation Principle (ISP)**
ะะฐะถะดัะน ะธะฝัะตััะตะนั ัะพะดะตัะถะธั ัะพะปัะบะพ ะฝะตะพะฑัะพะดะธะผัะต ะผะตัะพะดั.

### 5. **Dependency Inversion Principle (DIP)**
Services ะทะฐะฒะธััั ะพั ะธะฝัะตััะตะนัะพะฒ, ะฝะต ะพั ะบะพะฝะบัะตัะฝัั ัะตะฐะปะธะทะฐัะธะน:
```typescript
constructor(private userRepository: IUserRepository) {}
```

## ๐ ะกะปะพะธ ะฐััะธัะตะบัััั

```
โโโโโโโโโโโโโโโโโโโ
โ  Express Routes โ  โ API ัะฝะดะฟะพะธะฝัั
โโโโโโโโโโโโโโโโโโโค
โ    Services     โ  โ ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โโโโโโโโโโโโโโโโโโโค
โ  Repositories   โ  โ ะะฐะฑะพัะฐ ั ะะ
โโโโโโโโโโโโโโโโโโโค
โ     Prisma      โ  โ ORM
โโโโโโโโโโโโโโโโโโโค
โ   PostgreSQL    โ  โ ะะฐะทะฐ ะดะฐะฝะฝัั
โโโโโโโโโโโโโโโโโโโ
```

## ๐๏ธ ะะฐะทะฐ ะดะฐะฝะฝัั: PostgreSQL + Prisma

### ะะพัะตะผั PostgreSQL?
โ ะะฐะดัะถะฝะฐั ะธ ะผะฐัััะฐะฑะธััะตะผะฐั ะกะฃะะ
โ ACID ััะฐะฝะทะฐะบัะธะธ
โ ะัะปะธัะฝะฐั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั
โ Serverless-friendly (Vercel Postgres, Neon, Supabase)
โ ะะพะปะฝะพัะตะบััะพะฒัะน ะฟะพะธัะบ
โ JSONB ะดะปั ะณะธะฑะบะพััะธ

### ะะพัะตะผั Prisma?
โ ะัะปะธัะฝัะน TypeScript support
โ ะฃะดะพะฑะฝัะต ะผะธะณัะฐัะธะธ
โ ะะฒัะพะณะตะฝะตัะฐัะธั ัะธะฟะพะฒ
โ ะฅะพัะพัะธะน DX
โ ะัััะพะตะฝะฝะฐั ะฒะฐะปะธะดะฐัะธั

## ๐ API Endpoints

### Users
- `POST /api/users` - ะกะพะทะดะฐัั ะฟะพะปัะทะพะฒะฐัะตะปั
- `GET /api/users/:id` - ะะพะปััะธัั ะฟะพะปัะทะพะฒะฐัะตะปั

### Campaigns
- `POST /api/campaigns` - ะกะพะทะดะฐัั ะบะฐะผะฟะฐะฝะธั
- `GET /api/campaigns/:id` - ะะพะปััะธัั ะบะฐะผะฟะฐะฝะธั
- `GET /api/campaigns/user/:userId` - ะัะต ะบะฐะผะฟะฐะฝะธะธ ะฟะพะปัะทะพะฒะฐัะตะปั

### Links
- `POST /api/links` - ะกะพะทะดะฐัั ะบะพัะพัะบัั ัััะปะบั
- `GET /api/links/:shortCode` - ะะตัะตะนัะธ ะฟะพ ัััะปะบะต (ะทะฐะฟะธััะฒะฐะตั ะบะปะธะบ)

## ๐ ะะตะทะพะฟะฐัะฝะพััั

- [x] CORS ะฝะฐัััะพะนะบะฐ
- [x] Helmet ะดะปั ะทะฐัะธัั ะทะฐะณะพะปะพะฒะบะพะฒ
- [x] Valition ั Zod
- [ ] TODO: JWT ะฐััะตะฝัะธัะธะบะฐัะธั
- [ ] TODO: Rate limiting
- [ ] TODO: SQL injection protection (ะธัะฟะพะปัะทัะตััั Prisma)

## ๐ ะะธะณัะฐัะธะธ

```bash
# ะกะพะทะดะฐัั ะฝะพะฒัั ะผะธะณัะฐัะธั
npm run prisma:migrate

# ะัะธะผะตะฝะธัั ะผะธะณัะฐัะธะธ
npm run prisma:push

# ะกะณะตะฝะตัะธัะพะฒะฐัั Prisma Client
npm run prisma:generate
```

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

```bash
# ะะฐะฟะพะปะฝะธัั ะะ ัะตััะพะฒัะผะธ ะดะฐะฝะฝัะผะธ
npm run seed
```

## ๐ฆ Production build

```bash
npm run build
npm start
```

## ๐ ะะตะฟะปะพะน ะฝะฐ Vercel

1. ะะพะดะบะปััะธ ัะตะฟะพะทะธัะพัะธะน ะบ Vercel
2. ะะพะฑะฐะฒั `.env` ะฟะตัะตะผะตะฝะฝัะต (DATABASE_URL, JWT_SECRET)
3. ะะตะฟะปะพะน ะฟัะพะธะทะพะนะดัั ะฐะฒัะพะผะฐัะธัะตัะบะธ

## ๐ ะะพะดะดะตัะถะบะฐ

ะะปั ะฒะพะฟัะพัะพะฒ ะธ ะฟัะตะดะปะพะถะตะฝะธะน ัะพะทะดะฐะฒะฐะน Issues ะฒ ัะตะฟะพะทะธัะพัะธะธ.
